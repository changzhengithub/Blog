<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>组件之间的通信 | Chang&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/logo.ico">
    <meta name="description" content="我的个人博客，记录点滴">
    <link rel="preload" href="/assets/css/0.styles.7950d16d.css" as="style"><link rel="preload" href="/assets/js/app.f6fbff2b.js" as="script"><link rel="preload" href="/assets/js/2.85410337.js" as="script"><link rel="preload" href="/assets/js/63.cf425479.js" as="script"><link rel="prefetch" href="/assets/js/10.32e4f8a8.js"><link rel="prefetch" href="/assets/js/11.6aa3f937.js"><link rel="prefetch" href="/assets/js/12.fed39cea.js"><link rel="prefetch" href="/assets/js/13.bb35fb28.js"><link rel="prefetch" href="/assets/js/14.ee238573.js"><link rel="prefetch" href="/assets/js/15.9c529ac7.js"><link rel="prefetch" href="/assets/js/16.cd9b3d95.js"><link rel="prefetch" href="/assets/js/17.bcccae3a.js"><link rel="prefetch" href="/assets/js/18.2c5af098.js"><link rel="prefetch" href="/assets/js/19.9e7cf178.js"><link rel="prefetch" href="/assets/js/20.055193e0.js"><link rel="prefetch" href="/assets/js/21.de6d9ec2.js"><link rel="prefetch" href="/assets/js/22.831b73c3.js"><link rel="prefetch" href="/assets/js/23.f13804d2.js"><link rel="prefetch" href="/assets/js/24.d260914c.js"><link rel="prefetch" href="/assets/js/25.3d0ab69b.js"><link rel="prefetch" href="/assets/js/26.481f0cf0.js"><link rel="prefetch" href="/assets/js/27.db2248c7.js"><link rel="prefetch" href="/assets/js/28.a5f9180c.js"><link rel="prefetch" href="/assets/js/29.f532f4fa.js"><link rel="prefetch" href="/assets/js/3.15faf289.js"><link rel="prefetch" href="/assets/js/30.4d5508d6.js"><link rel="prefetch" href="/assets/js/31.696161f9.js"><link rel="prefetch" href="/assets/js/32.a7c6f3e3.js"><link rel="prefetch" href="/assets/js/33.2ea45e61.js"><link rel="prefetch" href="/assets/js/34.ed783e74.js"><link rel="prefetch" href="/assets/js/35.de493cf1.js"><link rel="prefetch" href="/assets/js/36.d0a7a0d9.js"><link rel="prefetch" href="/assets/js/37.8f938617.js"><link rel="prefetch" href="/assets/js/38.ce76f1e9.js"><link rel="prefetch" href="/assets/js/39.5c6e904c.js"><link rel="prefetch" href="/assets/js/4.79e3ce3d.js"><link rel="prefetch" href="/assets/js/40.f046a8d5.js"><link rel="prefetch" href="/assets/js/41.72957ebf.js"><link rel="prefetch" href="/assets/js/42.b39a5caf.js"><link rel="prefetch" href="/assets/js/43.3734b83e.js"><link rel="prefetch" href="/assets/js/44.db5e6e59.js"><link rel="prefetch" href="/assets/js/45.7d245d6d.js"><link rel="prefetch" href="/assets/js/46.4c5e0d8b.js"><link rel="prefetch" href="/assets/js/47.982fd453.js"><link rel="prefetch" href="/assets/js/48.060562fa.js"><link rel="prefetch" href="/assets/js/49.2611f52d.js"><link rel="prefetch" href="/assets/js/5.948f9f41.js"><link rel="prefetch" href="/assets/js/50.13fb8ae4.js"><link rel="prefetch" href="/assets/js/51.049a8696.js"><link rel="prefetch" href="/assets/js/52.1e4e46ae.js"><link rel="prefetch" href="/assets/js/53.e4ef3cb2.js"><link rel="prefetch" href="/assets/js/54.560f3d63.js"><link rel="prefetch" href="/assets/js/55.f51eb24a.js"><link rel="prefetch" href="/assets/js/56.54c5fecc.js"><link rel="prefetch" href="/assets/js/57.7003c375.js"><link rel="prefetch" href="/assets/js/58.ba30fef7.js"><link rel="prefetch" href="/assets/js/59.ad3ca957.js"><link rel="prefetch" href="/assets/js/6.129e48e5.js"><link rel="prefetch" href="/assets/js/60.392eac3f.js"><link rel="prefetch" href="/assets/js/61.d5128b7f.js"><link rel="prefetch" href="/assets/js/62.e9eb0671.js"><link rel="prefetch" href="/assets/js/64.db7988a0.js"><link rel="prefetch" href="/assets/js/65.87677e98.js"><link rel="prefetch" href="/assets/js/66.1df897f5.js"><link rel="prefetch" href="/assets/js/67.46ce0dd6.js"><link rel="prefetch" href="/assets/js/68.fc07ecab.js"><link rel="prefetch" href="/assets/js/69.cca4b871.js"><link rel="prefetch" href="/assets/js/7.1ab5be1b.js"><link rel="prefetch" href="/assets/js/70.0a02ce34.js"><link rel="prefetch" href="/assets/js/71.ea2646d8.js"><link rel="prefetch" href="/assets/js/8.ba7d142b.js"><link rel="prefetch" href="/assets/js/9.e32e8f60.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7950d16d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Chang's blog" class="logo"> <span class="site-name can-hide">Chang's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/basic/" class="nav-link">
  Basic
</a></div><div class="nav-item"><a href="/vue/" class="nav-link router-link-active">
  Vue
</a></div><div class="nav-item"><a href="/others/" class="nav-link">
  Others
</a></div><div class="nav-item"><a href="https://juejin.im/user/1714893870337518" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/changzhengithub" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/basic/" class="nav-link">
  Basic
</a></div><div class="nav-item"><a href="/vue/" class="nav-link router-link-active">
  Vue
</a></div><div class="nav-item"><a href="/others/" class="nav-link">
  Others
</a></div><div class="nav-item"><a href="https://juejin.im/user/1714893870337518" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/changzhengithub" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>基础内容</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/basic/vue知识点.html" class="sidebar-link">vue知识点</a></li><li><a href="/vue/basic/vue风格指南.html" class="sidebar-link">风格指南</a></li><li><a href="/vue/basic/在组件上使用v-model.html" class="sidebar-link">在自定义组件上使用v-model进行数据双向绑定</a></li><li><a href="/vue/basic/组件之间的通信.html" class="active sidebar-link">组件之间的通信</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/basic/组件之间的通信.html#最基本的props-emit父子组件之间" class="sidebar-link">最基本的props/$emit父子组件之间</a></li><li class="sidebar-sub-header"><a href="/vue/basic/组件之间的通信.html#refs-children和-parent父子组件之间" class="sidebar-link">$refs/$children和$parent父子组件之间</a></li><li class="sidebar-sub-header"><a href="/vue/basic/组件之间的通信.html#使用中央事件总线-兄弟组件之间。" class="sidebar-link">使用中央事件总线，兄弟组件之间。</a></li><li class="sidebar-sub-header"><a href="/vue/basic/组件之间的通信.html#使用-attrs-和-listeners-跨组件" class="sidebar-link">使用 $attrs 和 $listeners 跨组件</a></li><li class="sidebar-sub-header"><a href="/vue/basic/组件之间的通信.html#provide-inject-依赖注入跨组件" class="sidebar-link">provide/inject 依赖注入跨组件</a></li><li class="sidebar-sub-header"><a href="/vue/basic/组件之间的通信.html#使用vuex和localstorage-跨组件" class="sidebar-link">使用vuex和localStorage 跨组件</a></li></ul></li><li><a href="/vue/basic/vue过渡效果实现.html" class="sidebar-link">vue过渡效果实现</a></li><li><a href="/vue/basic/axios封装.html" class="sidebar-link">封装axios</a></li><li><a href="/vue/basic/vue添加typescript.html" class="sidebar-link">vue-cli3.0添加typescript</a></li><li><a href="/vue/basic/vue添加flex.html" class="sidebar-link">vue添加sass</a></li><li><a href="/vue/basic/搭建vue项目工程.html" class="sidebar-link">搭建vue项目工程</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3.0</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue Router</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vuex</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Faq</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="组件之间的通信"><a href="#组件之间的通信" class="header-anchor">#</a> 组件之间的通信</h1> <h2 id="最基本的props-emit父子组件之间"><a href="#最基本的props-emit父子组件之间" class="header-anchor">#</a> 最基本的props/$emit父子组件之间</h2> <p><code>props</code>/<code>$emit</code> 是父子组件之间最基本的通信了，父组件通过props的方式向子组件传递数据，而子组件可以通过$emit向父组件通信。</p> <p>通过<code>props</code>/<code>$emit</code>这种基本方式演变的父子组件间的数据双向绑定通信还有 <code>v-model</code> / <code>.sync</code> 。</p> <p><strong>v-model指令</strong></p> <p><code>v-model</code>本来是应用在表单上进行双向绑定的，他的本质是会默认为组件绑定名为 value 的 prop 和名为 input 的事件。后来通过 <code>model</code> 选项自定义 props和 event 名代替 <code>props</code>/<code>$emit</code> 在组件上实现数据的双向绑定。</p> <p>参考链接：<a href="/vue/%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BD%BF%E7%94%A8v-model">在组件上使用v-model</a></p> <p>但是<code>v-model</code>指令在组件上只能绑定一个数据，只能使用一次，没有办法绑定多个，不过vue3中可以通过 v-model:event1=xxx 跟参数来添加多个<code>v-model</code>。</p> <p><strong>.sync 修饰符</strong></p> <p><code>v-model</code> 这种形式只能实现一个数据在组件上进行双向绑定，如果要实现多个数据进行双向绑定，可以是 <code>.sync</code> 修饰符 来简化操作。</p> <p>参考链接：[在组件上使用v-model](/vue/在组件上使用v-model/.sync 修饰符)</p> <p>其实 <code>.sync</code> 和 <code>v-model</code> 本质上都是相同的，都是通过 props/$emit 进行父子组件之间的通信，都不是真正的双向绑定，而是语法糖。只不过<code>.sync</code>更灵活一点，可以给绑定多个数据。</p> <h2 id="refs-children和-parent父子组件之间"><a href="#refs-children和-parent父子组件之间" class="header-anchor">#</a> <code>$refs</code>/<code>$children</code>和<code>$parent</code>父子组件之间</h2> <p>父子组件通过<code>$children</code>和<code>$parent</code>来相互各自的实例，调用其中的方法或属性进行相互操作，<code>$refs</code>则是父组件通过在子组件上绑定 <code>ref</code> 来获取和操作子组件的实例或DOM元素。</p> <p><strong>通过访问父组件实例 <code>$parent</code>：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$parent  <span class="token comment">// 获取父组件实例</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>name  <span class="token comment">// 获取父组件数据</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 调用父组件方法</span>
</code></pre></div><p><strong>访问子组件实例 <code>ref</code>/ <code>$children</code>：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>son   <span class="token comment">// 获取子组件</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>son<span class="token punctuation">.</span>age <span class="token comment">// 获取子组件数据</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>son<span class="token punctuation">.</span><span class="token function">getAttr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 调用子组件方法</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>$children     <span class="token comment">// 获取子组件数组</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age  <span class="token comment">// 获取子组件数据</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 调用子组件方法</span>
</code></pre></div><h2 id="使用中央事件总线-兄弟组件之间。"><a href="#使用中央事件总线-兄弟组件之间。" class="header-anchor">#</a> 使用中央事件总线，兄弟组件之间。</h2> <p>使用<code>event Bus</code>中央事件总线来通信，主要是通过创建一个Vue实例来当做桥梁，然后组件中引入这个实例，通过这个实例 $emit 提交事件，然后在另一个组件中通过 $on 来接收事件。</p> <p>第一步：创建中间桥梁</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// event-bus.js</span>

<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> EventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>第二步：发送事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// A 组件</span>
<span class="token keyword">import</span> EventBus <span class="token keyword">from</span> <span class="token string">'@/event-bus'</span>

methods<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token comment">// event bus emit</span>
  <span class="token function">emitEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    EventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'EMIT_EVENT'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>第三步：接收事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// B 组件</span>
<span class="token keyword">import</span> EventBus <span class="token keyword">from</span> <span class="token string">'@/event-bus'</span>

<span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// event bus on</span>
  EventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'EMIT_EVENT'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>中央事件总线适合一些好维护的小项目，但是大项目就不合适了，状态多了就难维护了，最好使用vuex状态管理器。</p> <h2 id="使用-attrs-和-listeners-跨组件"><a href="#使用-attrs-和-listeners-跨组件" class="header-anchor">#</a> 使用 <code>$attrs</code> 和 <code>$listeners</code> 跨组件</h2> <p>父子传值 <code>props</code> 和子传父 <code>$emit</code> 的话跨一级传递还好，但是跨多个级别传递的话就会非常麻烦，而<code>$attrs</code> 和 <code>$listeners</code>就是他们的加强版，不需要每个都要传，只需要在每个组件上绑定这两个属性，那么绑定的组件就可以获取最顶级父组件传递的 <code>props</code> 值和子组件发送的 <code>$emit</code> 事件。</p> <p><code>$attrs</code> 来获取父组件传递的props值 <code></code>。</p> <p>中间的组件都要 添加 <code>v-bind='$attrs' v-on='$listeners'</code> 这两个属性才能监听到，并且中间的组件也能监听到传递的 props 和发送的事件。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 最顶级父组件中接收孙组件传递的事件 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>father-com</span> <span class="token attr-name">:age</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@send-msg</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getMsg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>father-com</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token number">18</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父组件获取到孙组件发送的事件</span>
    <span class="token function-variable function">getMsg</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// xxxxx</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'father'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  inheritAttrs<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div&gt;
      &lt;p&gt;父组件：{{$attrs.age}}&lt;/p&gt;
      &lt;son v-bind='$attrs' v-on='$listeners'&gt;&lt;/son&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'son'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  inheritAttrs<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getValue</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token comment">// xxxxx</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div&gt;
      &lt;p&gt;子组件：{{$attrs.age}}&lt;/p&gt;
      &lt;grandson v-bind='$attrs' v-on='$listeners' @send-msg=&quot;getValue&quot;&gt;&lt;/grandson&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 孙组件进行发送事件</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'grandson'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  inheritAttrs<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'send-msg'</span><span class="token punctuation">,</span> <span class="token string">'xxxxx'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div&gt;
      &lt;p&gt;孙组件：{{$attrs.age}}&lt;/p&gt;
      &lt;button @click=&quot;sendMsg&quot;&gt;发送事件&lt;/button&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="provide-inject-依赖注入跨组件"><a href="#provide-inject-依赖注入跨组件" class="header-anchor">#</a> <code>provide</code>/<code>inject</code> 依赖注入跨组件</h2> <p><code>provide</code>/<code>inject</code> 这对选项需要一起使用，以允许一个祖先组件向其所有子孙后代注入一个依赖，不论组件层次有多深，并在其上下游关系成立的时间里始终生效。可以把依赖注入看作一部分“大范围有效的 prop”。</p> <ul><li><code>provide</code> 选项应该是一个对象或返回一个对象的函数。</li> <li><code>inject</code> 选项应该是一个字符串数组，或一个对象</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>提示：provide 和 inject 绑定并不是可响应的。这是刻意为之的。然而，如果你传入了一个可监听的对象，那么其对象的 property 还是可响应的。</p></div> <p>提供属性：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父级组件提供 'foo'</span>
<span class="token keyword">var</span> Provider <span class="token operator">=</span> <span class="token punctuation">{</span>
  provide<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token string">'bar'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 子组件注入 'foo'</span>
<span class="token keyword">var</span> Child <span class="token operator">=</span> <span class="token punctuation">{</span>
  inject<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">)</span> <span class="token comment">// =&gt; &quot;bar&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>提供方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父级组件提供 'getMap' 方法</span>
<span class="token keyword">var</span> Provider <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">provide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      getName<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>getName<span class="token punctuation">,</span>
      msg<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'chang'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子组件注入 'getName'</span>
<span class="token keyword">var</span> Child <span class="token operator">=</span> <span class="token punctuation">{</span>
  inject<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'getName'</span><span class="token punctuation">,</span> <span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">)</span> <span class="token comment">//</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; 'chang'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="使用vuex和localstorage-跨组件"><a href="#使用vuex和localstorage-跨组件" class="header-anchor">#</a> 使用vuex和localStorage 跨组件</h2> <p>vuex状态管理器和localStorage本地存储都适合vue项目全局来通信，vuex比较庞大，比较适合大项目，vuex有个不好就是页面刷新随之里面的状态也被刷新了，我们可以结合localStorage来把状态存储在本地，刷新时可以先获取本地有没有，然后再保存在vuex中。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/1/2020, 6:02:30 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue/basic/在组件上使用v-model.html" class="prev">
        在自定义组件上使用v-model进行数据双向绑定
      </a></span> <span class="next"><a href="/vue/basic/vue过渡效果实现.html">
        vue过渡效果实现
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f6fbff2b.js" defer></script><script src="/assets/js/2.85410337.js" defer></script><script src="/assets/js/63.cf425479.js" defer></script>
  </body>
</html>
