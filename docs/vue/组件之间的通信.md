# 组件之间的通信

1、使用 `props` 父传子和 `$emit` 子传父

  单个 `$emit` 发送事件，我们可以使用 v-model 进行双向绑定来代替。
  

2、vm.$ref.[child]和vm.$parent(父子组件之间的显示调用)

3、使用中央事件总线，兄弟组件之间。

通过vm.$emit和vm.$on通过 vm.$emit 触发当前实例上的事件，并将参数传递给监听器，通过 vm.$on 监听当前实例上的自定义事件。

4、使用 `$attrs` 和 `$listeners` 跨组件传值和监听事件

父子传值 `props` 和子传父 `$emit` 的话跨一级传递还好，但是跨多个级别传递的话就会非常麻烦，而`$attrs` 和 `$listeners`就是他们的加强版，不需要每个都要传，只需要在每个组件上绑定这两个属性，那么绑定的组件就可以获取最顶级父组件传递的 `props` 值和子组件发送的 `$emit` 事件。

`$attrs` 来获取父组件传递的props值 `{{$attrs.age}}`。

中间的组件都要 添加 `v-bind='$attrs' v-on='$listeners'` 这两个属性才能监听到，并且中间的组件也能监听到传递的 props 和发送的事件。
```html
<div id="app">
  <!-- 最顶级父组件中接收孙组件传递的事件 -->
  <father-com :age="age" @send-msg="getMsg"></father-com>
</div>
```
```js
var vm = new Vue({
  el: '#app',
  data: {
    age: 18
  },
  methods: {
    // 父组件获取到孙组件发送的事件
    getMsg: function(name) {
      console.log(name) // xxxxx
    }
  }
})
Vue.component('father', {
  inheritAttrs: true,
  template: `
    <div>
      <p>父组件：{{$attrs.age}}</p>
      <son v-bind='$attrs' v-on='$listeners'></son>
    </div>
  `
})
Vue.component('son', {
  inheritAttrs: true,
  methods: {
    getValue: function(name) {
      console.log(name) // xxxxx
    }
  },
  template: `
    <div>
      <p>子组件：{{$attrs.age}}</p>
      <grandson v-bind='$attrs' v-on='$listeners' @send-msg="getValue"></grandson>
    </div>
  `
})
// 孙组件进行发送事件
Vue.component('grandson', {
  inheritAttrs: true,
  methods: {
    sendMsg() {
      this.$emit('send-msg', 'xxxxx')
    },
  },
  template: `
    <div>
      <p>孙组件：{{$attrs.age}}</p>
      <button @click="sendMsg">发送事件</button>
    </div>
  `
})
```

5、使用 provide/inject 注入 进行事件和值传递。

6、使用vuex和localStorage
