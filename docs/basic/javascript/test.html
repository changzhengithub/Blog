<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body style="height: 3000px;">

  <script>
    var arr = [1, 1, '1', 3, 'a', 'b', true, true, false, 'true', {}, {}];
    /*
    function unique(arr) {
      var res = []
      for (var index = 0; index < arr.length; index++) {
        for (var j =0; j< res.length;j++) {
          if (arr[index] === res[j]) break;
        }
        if (j === res.length) res.push(arr[index])
      }
      return res
    }
    
    // 使用对象，把当前值添加到对象中，如果对象有这个值就说明重复了，没有就推入新数组
    function unique(arr) {
      var res = []
      var obj = {}
      for (var i = 0; i < arr.length; i++) {
        if (!obj[arr[i]]) {
          res.push(arr[i])
          obj[arr[i]] = arr[i]
        }
      }
      return res
    }
    function unique(arr) {
      var res = []
      var obj = {}
      for (var i = 0; i < arr.length; i++) {
        if (!obj[typeof arr[i] + arr[i]]) {
          res.push(arr[i])
          obj[typeof arr[i] + arr[i]] = 1 // 随便赋值一个不为false的值
        }
      }
      return res
    }
    // indexOf() 一次for循环，在新的数组中能查找到就退出，查不到就推进新数组。
    function unique(arr) {
      var res = []
      for (var i = 0; i < arr.length; i++) {
        if (res.indexOf(arr[i]) === -1) {
          res.push(arr[i])
        }
      }
      return res
    }

      function unique(arr) {
      var res = []
      for (var i = 0; i < arr.length; i++) {
        if (!res.includes(arr[i])) res.push(arr[i])
      }
      return res
    }
    
    function unique(arr) {
      return [...new Set(arr)]
    }
    console.log(unique(arr))

    function throttle(fn, delay) {
      var start = Date.now();
      return function() {
        var _this = this;
        var args = arguments;
        var end = Date.now();
        if (end - start > delay) {
          fn.apply(_this, args);
          start = end;
        }
      }
    }
    function handle(arg) {
      console.log(arg)
    }
    var debounceCallback = throttle(handle, 1000);
    window.addEventListener('scroll', function(e) {
      debounceCallback(e)
    })

    var obj = {
      a: [1, 2, {
        g: [1, 3]
      }],
      b: 2,
      c: {
        d: [1, 2, 3, {
          f: 1
        }]
      }
    }

    function deepClone(target) {
      if (typeof target === 'object') {
        var res = Array.isArray(target) ? [] : {};
        for (var key in target) {
          res[key] = deepClone(target[key])
        }
        return res
      } else {
        return target
      }
    }
    console.log(deepClone(obj))


    function isObject(target) {
      return (typeof target === 'object' || typeof target === 'function') && target !== null;
    }

    function deepClone(target, map = new Map()) {
      // 先判断该引用类型是否被 拷贝过
      if (map.get(target)) {
        return target;
      }
      // 获取当前值的构造函数：获取它的类型
      let constructor = target.constructor;
      // 检测当前对象target是否与 正则、日期格式对象匹配
      if (/^(RegExp|Date)$/i.test(constructor.name)) {
        return new constructor(target); // 创建一个新的特殊对象(正则类/日期类)的实例
      }
      if (isObject(target)) {
        map.set(target, true); // 为循环引用的对象做标记
        const cloneTarget = Array.isArray(target) ? [] : {};
        for (let prop in target) {
          if (target.hasOwnProperty(prop)) {
            cloneTarget[prop] = deepClone(target[prop], map);
          }
        }
        return cloneTarget;
      } else {
        return target;
      }
    }
    */

    function ajax(params) {
      return new Promise(function (resolve, reject) {
        var xhr = null;
        xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        var data = "";
        if (params.data) {
          for (var key in params.data) {
            data += key + "=" + params.data[key] + "&"
          }
          var i = data.lastIndexOf("&");
          data = data.substring(0, i);
        }
        if (data && params.method == "get") {
          params.url = params.url + "?" + data;
        }
        xhr.open(params.url, params.method, true);
        //send
        if (params.method == "get") {
          xhr.send();
        } else {
          xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          xhr.send(data);
        }
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) {
            resolve(JSON.parse(xhr.responseText))
          } else {
            reject(xhr.err)
          }
        };
      })
    }
  </script>
</body>

</html>